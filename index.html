<div id="gameContainer">
        <div id="gameHeader">
            ðŸŽ¯ Bubble Shooter ðŸŽ¯
        </div>
        
        <div id="gameUI">
            <div>Score: <span id="score">0</span></div>
            <div>Level: <span id="level">1</span></div>
        </div>

        <canvas id="gameCanvas"></canvas>
        
        <div id="shooter"></div>
    </div>

    <div id="gameOver">
        <div id="gameOverContent">
            <h2>ðŸŽ‰ Great Job! ðŸŽ‰</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <button onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');

        // Game state
        let score = 0;
        let level = 1;
        let bubbles = [];
        let targets = [];
        let particles = [];
        let gameRunning = true;

        // Colors for bubbles and targets
        const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#fab1a0', '#fd79a8', '#a29bfe'];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - 60; // Account for header
        }

        function getRandomColor() {
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function createTarget() {
            const target = {
                x: Math.random() * (canvas.width - 60) + 30,
                y: Math.random() * (canvas.height * 0.6) + 50,
                radius: 25 + Math.random() * 15,
                color: getRandomColor(),
                vx: (Math.random() - 0.5) * 2,
                vy: (Math.random() - 0.5) * 2
            };
            targets.push(target);
        }

        function createBubble(x, y, targetX, targetY) {
            const bubble = {
                x: x,
                y: y,
                radius: 15,
                color: getRandomColor(),
                vx: (targetX - x) * 0.01,
                vy: (targetY - y) * 0.01,
                speed: 8
            };
            
            const distance = Math.sqrt(bubble.vx * bubble.vx + bubble.vy * bubble.vy);
            bubble.vx = (bubble.vx / distance) * bubble.speed;
            bubble.vy = (bubble.vy / distance) * bubble.speed;
            
            bubbles.push(bubble);
        }

        function createParticle(x, y, color) {
            for (let i = 0; i < 8; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    color: color,
                    life: 30,
                    maxLife: 30
                });
            }
        }

        function drawCircle(x, y, radius, color) {
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = 'rgba(255,255,255,0.6)';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function updateGame() {
            if (!gameRunning) return;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update and draw bubbles
            for (let i = bubbles.length - 1; i >= 0; i--) {
                const bubble = bubbles[i];
                bubble.x += bubble.vx;
                bubble.y += bubble.vy;

                drawCircle(bubble.x, bubble.y, bubble.radius, bubble.color);

                // Remove bubbles that go off screen
                if (bubble.x < 0 || bubble.x > canvas.width || bubble.y < 0 || bubble.y > canvas.height) {
                    bubbles.splice(i, 1);
                    continue;
                }

                // Check collision with targets
                for (let j = targets.length - 1; j >= 0; j--) {
                    const target = targets[j];
                    const dx = bubble.x - target.x;
                    const dy = bubble.y - target.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < bubble.radius + target.radius) {
                        // Hit!
                        createParticle(target.x, target.y, target.color);
                        score += 10;
                        scoreElement.textContent = score;
                        
                        bubbles.splice(i, 1);
                        targets.splice(j, 1);
                        break;
                    }
                }
            }

            // Update and draw targets
            for (let target of targets) {
                target.x += target.vx;
                target.y += target.vy;

                // Bounce off walls
                if (target.x <= target.radius || target.x >= canvas.width - target.radius) {
                    target.vx = -target.vx;
                }
                if (target.y <= target.radius || target.y >= canvas.height * 0.7) {
                    target.vy = -target.vy;
                }

                drawCircle(target.x, target.y, target.radius, target.color);
            }

            // Update and draw particles
            for (let i = particles.length - 1; i >= 0; i--) {
                const particle = particles[i];
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.life--;

                const alpha = particle.life / particle.maxLife;
                ctx.fillStyle = particle.color + Math.floor(alpha * 255).toString(16).padStart(2, '0');
                ctx.fillRect(particle.x, particle.y, 4, 4);

                if (particle.life <= 0) {
                    particles.splice(i, 1);
                }
            }

            // Check if level complete
            if (targets.length === 0) {
                level++;
                levelElement.textContent = level;
                
                // Create more targets for next level
                const targetCount = Math.min(3 + level, 10);
                for (let i = 0; i < targetCount; i++) {
                    setTimeout(() => createTarget(), i * 200);
                }
            }

            // End game if score reaches 500 (or adjust as needed)
            if (score >= 500) {
                endGame();
            }
        }

        function endGame() {
            gameRunning = false;
            finalScoreElement.textContent = score;
            gameOverElement.style.display = 'flex';
        }

        function restartGame() {
            score = 0;
            level = 1;
            bubbles = [];
            targets = [];
            particles = [];
            gameRunning = true;
            
            scoreElement.textContent = score;
            levelElement.textContent = level;
            gameOverElement.style.display = 'none';
            
            // Create initial targets
            for (let i = 0; i < 3; i++) {
                createTarget();
            }
        }

        // Event listeners
        canvas.addEventListener('click', (e) => {
            if (!gameRunning) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const shooterX = canvas.width / 2;
            const shooterY = canvas.height - 40;
            
            createBubble(shooterX, shooterY, x, y);
        });

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!gameRunning) return;
            
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            
            const shooterX = canvas.width / 2;
            const shooterY = canvas.height - 40;
            
            createBubble(shooterX, shooterY, x, y);
        });

        window.addEventListener('resize', resizeCanvas);

        // Initialize game
        resizeCanvas();
        restartGame();

        // Game loop
        setInterval(updateGame, 1000 / 60); // 60 FPS

        // Register service worker for offline functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4ge30pOw==');
        }
    </script>
